<!DOCTYPE html>
<html>
<head>
  <title>Abi Horizon Digital Notice Board</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    h1 { color: #2c3e50; }
    .notice {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .meta {
      font-size: 0.85em;
      color: #777;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Abi Horizon Digital Notice Board</h1>
  <div id="notices">Loading notices...</div>

  <script>
    const sheetAPI = 'https://script.google.com/macros/s/AKfycbxm089waErPbqiOmDaOp2ggyyICjGu30kwqEW8G3fMnAtf_0LTVhGJTLXAjBfe2vTSLnw/exec';

    fetch(sheetAPI)
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('notices');
        container.innerHTML = '';

        data.filter(n => n.Status === 'Active').forEach(notice => {
          const el = document.createElement('div');
          el.className = 'notice';
          el.innerHTML = `
            <h2>${notice.Title}</h2>
            <p>${notice.Description}</p>
            <div class="meta">
              <strong>Date:</strong> ${notice.Date} |
              <strong>Category:</strong> ${notice.Category} |
              <strong>Posted by:</strong> ${notice.PostedBy}
            </div>
          `;
          container.appendChild(el);
        });
      })
      .catch(err => {
        document.getElementById('notices').innerText = 'Failed to load notices.';
        console.error(err);
      });
  </script>
</body>
</html>
